<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Abrir Pacotinho de Cartinhas ‚Äî Demo</title>
  <style>
    :root{
      --bg1:#0f1226; --bg2:#1a1f4a; --accent:#4ec9f4; --accent2:#ffcc00; --ok:#46e39b; --danger:#ff6b6b;
    }
    *{box-sizing:border-box}
    body{margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial; color:#fff; background: radial-gradient(1200px 600px at 50% 20%, #222a6b 0%, #121530 60%, #0a0b14 100%); min-height:100vh; overflow:hidden}

    /* BG sparkle */
    .stars{position:fixed; inset:0; pointer-events:none; background: repeating-radial-gradient(circle at 30% -10%, rgba(255,255,255,.10), rgba(255,255,255,0) 80px), repeating-radial-gradient(circle at 80% 20%, rgba(255,255,255,.06), rgba(255,255,255,0) 60px)}

    /* Top bar */
    header{position:fixed; top:0; left:0; right:0; padding:14px 18px; display:flex; align-items:center; gap:12px; background:linear-gradient(180deg, rgba(0,0,0,.35), rgba(0,0,0,0)); z-index:5}
    header h1{font-size:18px; margin:0; letter-spacing:.6px; opacity:.9}
    header .pill{margin-left:auto; display:flex; gap:8px}
    .btn{appearance:none; border:0; padding:10px 14px; border-radius:999px; background:#2a2f7a; color:#fff; font-weight:600; cursor:pointer; box-shadow:0 6px 16px rgba(0,0,0,.25), inset 0 0 0 2px rgba(255,255,255,.06); transition:.2s transform,.2s filter}
    .btn:hover{transform:translateY(-1px)}
    .btn:active{transform:translateY(1px)}
    .btn.secondary{background:#1f234f}

    /* Main stage */
    .stage{position:relative; width:100%; height:100vh; display:grid; place-items:center; perspective:1200px}
    .platform{position:absolute; bottom:-80px; width:700px; height:240px; background: radial-gradient(ellipse at center, rgba(255,255,255,.08), rgba(255,255,255,0) 60%); filter:blur(2px); pointer-events:none}

    .pack-area{position:relative; width:340px; height:520px; display:grid; place-items:center; transform-style:preserve-3d}
    /* Controla quem fica na frente */
    .pack{position:relative; width:300px; height:460px; border-radius:24px; background:linear-gradient(135deg, #2b3a94, #3a9bd9 60%, #5be1ff); box-shadow: 0 30px 60px rgba(0,0,0,.45), inset 0 0 0 3px rgba(255,255,255,.2); overflow:hidden; cursor:pointer; transform: rotateX(10deg) rotateY(-8deg); transition: transform .6s cubic-bezier(.2,.8,.2,1), filter .4s, opacity .4s; z-index:2}
    .pack:hover{transform: rotateX(8deg) rotateY(-2deg) translateZ(6px); filter:brightness(1.05)}
    /* Quando abrir, o pack "sai da frente" */
    .pack-area.opened .pack{
      z-index:0;
      transform: translateY(120px) rotateX(30deg) rotateY(-6deg) scale(.98);
      filter: brightness(.8) blur(.2px);
      opacity:.25;
      pointer-events:none;
    }

    .foil{position:absolute; inset:0; background:conic-gradient(from 0deg at 50% 50%, #ffffff10, #ffffff00 10%, #ffffff10 20%, #ffffff00 30%, #ffffff10 40%, #ffffff00 50%, #ffffff10 60%, #ffffff00 70%, #ffffff10 80%, #ffffff00 90%, #ffffff10 100%); mix-blend-mode:overlay; animation:spin 8s linear infinite}
    @keyframes spin {to{transform:rotate(360deg)}}

    .logo{position:absolute; top:18px; left:18px; right:18px; height:68px; border-radius:14px; background:linear-gradient(180deg, #ffe08a, #ffb703); box-shadow:inset 0 0 0 2px rgba(0,0,0,.35), 0 12px 30px rgba(0,0,0,.35); display:grid; place-items:center; font-weight:900; letter-spacing:1px; color:#301b00}
    .ribbon{position:absolute; bottom:0; left:0; right:0; height:120px; background:linear-gradient(180deg, rgba(0,0,0,.0) 0%, rgba(0,0,0,.2) 30%, rgba(0,0,0,.5) 100%)}

    .tap{position:absolute; right:10px; bottom:10px; font-size:12px; opacity:.8}

    /* Cards */
    .fan{position:absolute; width:100%; height:100%; display:flex; align-items:center; justify-content:center; transform-style:preserve-3d; z-index:1}
    /* Ap√≥s abrir, cartas garantem prioridade visual */
    .pack-area.opened .fan{ z-index:5; }

    /* Card container (posicionamento/leque) */
    .card{position:absolute; width:240px; height:340px; transform-style:preserve-3d; transform-origin:center bottom; border-radius:16px; transition: transform .8s cubic-bezier(.2,.8,.2,1), filter .3s; box-shadow: 0 18px 40px rgba(0,0,0,.45)}

    /* Wrapper interno que faz o flip */
    .card-inner{position:absolute; inset:0; transform-style:preserve-3d; transition: transform .6s cubic-bezier(.2,.8,.2,1)}
    .card-inner.flip{transform: rotateY(180deg) translateZ(6px) scale(1.03)}

    .card-inner .face{position:absolute; inset:0; backface-visibility:hidden; border-radius:16px; overflow:hidden}
    .card-inner .back{background:linear-gradient(135deg, #0d0f23, #1b2358); border:2px solid #3b4cca; display:grid; place-items:center; font-weight:700; letter-spacing:1px}
    .card-inner .front{transform: rotateY(180deg); border:2px solid #ddd; background:#f6f6f6; display:flex; flex-direction:column}
    .front .art{flex:1; background: radial-gradient(circle at 30% 30%, #fff, #ddd 60%, #ccc 100%); display:grid; place-items:center; font-size:60px}
    .front .meta{padding:10px 12px; display:flex; justify-content:space-between; align-items:center; background:#fff}
    .tag{padding:6px 10px; border-radius:999px; font-size:12px; font-weight:700}
    .tag.common{background:#e9eefc; color:#2b3a94}
    .tag.rare{background:#fff5cc; color:#6b5200}
    .tag.epic{background:#ffe3f7; color:#7a1754}
    .tag.legend{background:#fff3ba; color:#8a6400; box-shadow:0 0 30px 6px rgba(255, 204, 0, .35)}

    .card:hover{filter:brightness(1.05)}

    /* Fan positions */
    .fan.ready .card{opacity:0; transform: translateY(60px) rotateX(0) rotateZ(0)}
    .fan.out .card{opacity:1}

    /* Particle burst */
    .burst{position:absolute; inset:0; pointer-events:none}
    .spark{position:absolute; width:6px; height:6px; background:#fff; border-radius:50%; box-shadow:0 0 12px #fff}

    /* Glow para raras */
    .glow{position:absolute; inset:-6px; border-radius:18px; background: radial-gradient(120px 160px at 50% 0%, rgba(255,245,200,.8), rgba(255,245,200,0) 70%), conic-gradient(from 0deg, rgba(255,215,0,.5), rgba(255,255,255,.0) 40%, rgba(255,215,0,.5)); filter: blur(14px); opacity:0; transition:.6s}
    .card.legendary .glow{opacity:1}

    /* CTA */
    .cta{position:absolute; bottom:24px; left:50%; transform:translateX(-50%); display:flex; gap:10px; z-index:6}

    /* Help */
    .help{position:fixed; bottom:18px; right:18px; font-size:12px; opacity:.75}

    @media (max-width: 640px){
      .pack{width:240px; height:380px}
      .card{width:200px; height:300px}
      .platform{width:480px}
    }
  </style>
</head>
<body>
  <div class="stars"></div>
  <header>
    <h1>Demo: Abertura de Pacotinho</h1>
    <div class="pill">
      <button class="btn secondary" id="btnReset" disabled>Novo Pacote</button>
      <button class="btn" id="btnSkip" disabled>Revelar Tudo</button>
    </div>
  </header>

  <main class="stage" id="stage">
    <div class="pack-area" id="packArea">
      <div class="pack" id="pack">
        <div class="logo">MIX AWARDS ‚Ä¢ CARDS</div>
        <div class="foil"></div>
        <div class="ribbon"></div>
        <div class="tap">Clique para abrir</div>
        <div class="burst" id="burst"></div>
      </div>
      <div class="fan ready" id="fan"></div>
    </div>
    <div class="platform"></div>
  </main>

  <div class="help">Dica: clique na carta para virar. A lend√°ria brilha ‚ú® ‚Äî Espa√ßo/Enter abre, "r" reinicia.</div>

  <script>
    const pack = document.getElementById('pack');
    const fan  = document.getElementById('fan');
    const burst = document.getElementById('burst');
    const btnSkip = document.getElementById('btnSkip');
    const btnReset = document.getElementById('btnReset');
    const packArea = document.getElementById('packArea');

    let opened = false;

    const rarities = [
      { key:'common',  label:'Comum' },
      { key:'rare',    label:'Rara' },
      { key:'epic',    label:'√âpica' },
      { key:'legend',  label:'Lend√°ria' },
    ];

    function rand(min,max){return Math.floor(Math.random()*(max-min+1))+min}

    function createCard(index, rarity){
      const card = document.createElement('div');
      card.className = 'card';
      card.style.zIndex = 10 + index;

      // Fan layout angles
      const spread = 45; // degrees spread total
      const start = -spread/2;
      const angle = start + (spread/(CARDS-1)) * index;
      const distance = 200; // how far to throw out
      const rz = angle; // Z rotation for fanning
      const tx = Math.sin(angle * Math.PI/180) * distance;
      const ty = Math.cos(Math.abs(angle) * Math.PI/180) * 40 - 60;

      card.dataset.tx = tx; card.dataset.ty = ty; card.dataset.rz = rz;

      // Wrapper que receber√° o flip
      const inner = document.createElement('div');
      inner.className = 'card-inner';

      const faceBack = document.createElement('div');
      faceBack.className = 'face back';
      faceBack.textContent = 'MIX ‚Ä¢ CARD';

      const faceFront = document.createElement('div');
      faceFront.className = 'face front';

      const art = document.createElement('div');
      art.className = 'art';
      const emojis = ['üî•','‚ö°Ô∏è','üíß','üåø','ü™®','üå™Ô∏è','üåô','‚òÄÔ∏è'];
      art.textContent = emojis[rand(0,emojis.length-1)];

      const meta = document.createElement('div');
      meta.className = 'meta';
      const left = document.createElement('strong'); left.textContent = `Carta #${index+1}`;
      const tag = document.createElement('span'); tag.className = 'tag ' + rarity.key; tag.textContent = rarity.label;

      meta.appendChild(left); meta.appendChild(tag);
      faceFront.appendChild(art); faceFront.appendChild(meta);

      const glow = document.createElement('div'); glow.className='glow';

      inner.appendChild(glow);
      inner.appendChild(faceBack);
      inner.appendChild(faceFront);
      card.appendChild(inner);

      // Rare visuals
      if(rarity.key === 'legend'){
        card.classList.add('legendary');
        card.style.borderRadius = '18px';
        card.style.boxShadow = '0 20px 60px rgba(255, 200, 0, .45), 0 18px 40px rgba(0,0,0,.45)';
        faceFront.style.border = '2px solid var(--accent2)';
      } else if(rarity.key==='epic'){
        faceFront.style.border = '2px solid #d34bdc';
      } else if(rarity.key==='rare'){
        faceFront.style.border = '2px solid #caa21a';
      }

      // Intera√ß√µes ‚Äî flip no wrapper interno
      card.addEventListener('click', ()=>{
        inner.classList.toggle('flip');
      });

      // posi√ß√£o inicial (escondida)
      card.style.transform = `translateY(80px) rotateZ(0deg)`;

      // ap√≥s append, anima para o leque
      setTimeout(()=>{
        fan.classList.add('out');
        card.style.transform = `translate(${tx}px, ${ty}px) rotateX(6deg) rotateZ(${rz}deg)`;
      }, 40 + index*120);

      return card;
    }

    function makeBurst(){
      burst.innerHTML = '';
      const count = 60;
      for(let i=0;i<count;i++){
        const s = document.createElement('div');
        s.className = 'spark';
        const x = 150, y = 230; // centro aproximado do pack
        s.style.left = x+'px'; s.style.top = y+'px';
        const angle = Math.random()*Math.PI*2;
        const speed = 80 + Math.random()*220;
        const dx = Math.cos(angle)*speed;
        const dy = Math.sin(angle)*speed;
        const dur = 700 + Math.random()*600;
        s.animate([
          { transform: 'translate(0,0) scale(1)', opacity:1 },
          { transform: `translate(${dx}px, ${dy}px) scale(0)` , opacity: 0 }
        ], { duration: dur, easing: 'cubic-bezier(.2,.8,.2,1)' });
        burst.appendChild(s);
      }
      // flash no pack
      pack.animate([
        { filter:'brightness(1)' },
        { filter:'brightness(1.7)' },
        { filter:'brightness(1)' }
      ], { duration: 420, easing:'ease-out' });
    }

    const CARDS = 5;

    function openPack(){
      if(opened) return; opened = true;
      pack.style.pointerEvents = 'none';
      btnSkip.disabled = false; btnReset.disabled = false;

      // shake pack
      pack.animate([
        { transform: 'rotateX(10deg) rotateY(-8deg) translateZ(0)' },
        { transform: 'rotateX(10deg) rotateY(-2deg) translateZ(6px)' },
        { transform: 'rotateX(12deg) rotateY(8deg) translateZ(10px)' },
        { transform: 'rotateX(8deg) rotateY(-4deg) translateZ(0)' }
      ], { duration: 700, iterations: 2, easing: 'ease-in-out' });

      // burst
      setTimeout(makeBurst, 450);

      // **** novo: garantir cartas acima e pack abaixo
      packArea.classList.add('opened');  // ativa CSS que joga o pack para tr√°s e d√° z-index maior ao leque

      // spawn cards
      const rareIndex = rand(1, CARDS-1); // garante que nem sempre √© a primeira
      fan.classList.remove('ready');
      fan.innerHTML = '';
      for(let i=0;i<CARDS;i++){
        let rarity = {key:'common', label:'Comum'};
        if(i === rareIndex){ rarity = {key:'legend', label:'Lend√°ria'}; }
        else if(Math.random() < .25){ rarity = {key:'rare', label:'Rara'}; }
        else if(Math.random() < .10){ rarity = {key:'epic', label:'√âpica'}; }
        const card = createCard(i, rarity);
        fan.appendChild(card);
      }
    }

    function revealAll(){
      document.querySelectorAll('.card-inner').forEach((c,i)=> setTimeout(()=> c.classList.add('flip'), i*120));
    }

    function resetAll(){
      opened = false;
      btnSkip.disabled = true; btnReset.disabled = true;
      fan.classList.add('ready');
      fan.innerHTML = '';
      pack.style.pointerEvents = 'auto';
      packArea.classList.remove('opened'); // volta o pack ao estado original
    }

    pack.addEventListener('click', openPack);
    btnSkip.addEventListener('click', revealAll);
    btnReset.addEventListener('click', resetAll);

    // Keyboard helpers
    window.addEventListener('keydown', (e)=>{
      if(e.key===' '|| e.key==='Enter'){ e.preventDefault(); if(!opened) openPack(); else revealAll(); }
      if(e.key==='r'){ resetAll(); }
    })
  </script>
</body>
</html>
